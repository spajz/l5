{"version":3,"sources":["added.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"added.js","sourcesContent":["// Add csrf token to all ajax calls\r\n$.ajaxSetup({\r\n    headers: {\r\n        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n    },\r\n    beforeSend: function () {\r\n        $('.ajax-loader').show();\r\n    },\r\n    complete: function () {\r\n        $('.ajax-loader').hide();\r\n    }\r\n});\r\n\r\n// Bootstrap file button\r\n$('body').on('change', '.btn-file :file', function () {\r\n    var input = $(this),\r\n        numFiles = input.get(0).files ? input.get(0).files.length : 1,\r\n        label = input.val().replace(/\\\\/g, '/').replace(/.*\\//, '');\r\n    input.trigger('fileselect', [numFiles, label]);\r\n});\r\n\r\n// Sort array by property   sortByProperty(myArray, \"name\");\r\nfunction sortByProperty(array, propertyName) {\r\n    return array.sort(function (a, b) {\r\n        return a[propertyName] - b[propertyName];\r\n    });\r\n}\r\n\r\n// Ajax loader\r\nfunction loaderShow() {\r\n    $('.ajax-loader').show();\r\n}\r\n\r\nfunction loaderHide() {\r\n    $('.ajax-loader').hide();\r\n}\r\n\r\n// Background color for drag & drop\r\nfunction colorSuccess(item) {\r\n    var color = item.css('background-color');\r\n    item.css('background-color', '#64c664')\r\n        .animate({'background-color': color}, 500, function () {\r\n            item.removeAttr('style');\r\n        });\r\n}\r\n\r\nfunction colorDanger(item) {\r\n    var color = item.css('background-color');\r\n    item.css('background-color', '#e71a1a')\r\n        .animate({'background-color': color}, 500, function () {\r\n            item.removeAttr('style');\r\n        });\r\n}\r\n\r\n// Custom functions\r\nfunction randomString(length) {\r\n    length = typeof length !== 'undefined' ? length : 8;\r\n    return Math.random().toString(36).slice(length);\r\n}\r\n\r\n// Get model (type: json | list | option)\r\nfunction getModel(model, column, type, extra) {\r\n    type = typeof type !== 'undefined' ? type : 'json';\r\n    column = typeof column !== 'undefined' ? column : '*';\r\n    var out = '';\r\n    $.ajax({\r\n        url: baseUrlAdmin + '/api/get-model',\r\n        type: 'post',\r\n        data: {\r\n            \"model\": model,\r\n            \"column\": column,\r\n            \"type\": type,\r\n            \"extra\": extra,\r\n        },\r\n        success: function (data, textStatus, jqXHR) {\r\n            out = data;\r\n        },\r\n        error: function (jqXHR, textStatus, errorThrown) {\r\n            alert('Server error.');\r\n        },\r\n        async: false\r\n    });\r\n    return out;\r\n}\r\n\r\nfunction resetForm(form) {\r\n    form.find('input:text, input:password, input:file, select, textarea').val('');\r\n    form.find('input:radio, input:checkbox')\r\n        .removeAttr('checked').removeAttr('selected');\r\n}\r\n\r\n$(document).ready(function () {\r\n//Loads the correct sidebar on window load,\r\n//collapses the sidebar on window resize.\r\n//Sets the min-height of #page-wrapper to window size\r\n    $(window).bind(\"load resize\", function () {\r\n        topOffset = 50;\r\n        width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;\r\n        if (width < 768) {\r\n            $('div.navbar-collapse').addClass('collapse');\r\n            topOffset = 100; // 2-row-menu\r\n        } else {\r\n            $('div.navbar-collapse').removeClass('collapse');\r\n        }\r\n\r\n        height = ((this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height) - 1;\r\n        height = height - topOffset;\r\n        if (height < 1) height = 1;\r\n        if (height > topOffset) {\r\n            $(\"#page-wrapper\").css(\"min-height\", (height) + \"px\");\r\n        }\r\n    });\r\n\r\n    // Menu\r\n    var url = window.location;\r\n    var element = $('ul.nav a').filter(function () {\r\n        return this.href == url || url.href.indexOf(this.href) == 0;\r\n    }).addClass('active').parent().parent().addClass('in').parent();\r\n    if (element.is('li')) {\r\n        element.addClass('active');\r\n    }\r\n\r\n    // Sortable\r\n    function initSortable() {\r\n        $('table.sortable').sortable({\r\n            axis: 'y',\r\n            items: 'tbody tr',\r\n            handle: '.btn-sort',\r\n            forcePlaceholderSize: true,\r\n            cancel: '',\r\n            placeholder: 'sortable-placeholder',\r\n            helper: function (e, ui) {\r\n                ui.children().each(function () {\r\n                    $(this).width($(this).width());\r\n                    $(this).height($(this).height());\r\n                });\r\n                return ui;\r\n            },\r\n            start: function (e, ui) {\r\n                $('.sortable-placeholder').height(ui.item.height());\r\n                ui.item.siblings(\"tr\").has(':checkbox:checked').not(\".ui-sortable-placeholder\").appendTo(ui.item).hide();\r\n            },\r\n            stop: function (e, ui) {\r\n                var items = ui.item.find(\"tr\");\r\n                ui.item.after(items.show());\r\n                colorSuccess(items);\r\n                colorSuccess(ui.item);\r\n                $('table.sortable input:checkbox').removeAttr('checked');\r\n            }\r\n\r\n        }).bind('sortupdate', function (e, ui) {\r\n            var sort = [];\r\n            $('table.sortable tbody tr').each(function (index) {\r\n                sort[index + 1] = $(this).data('id');\r\n            });\r\n            sortRows($('table.sortable').data('model'), sort, ui.item);\r\n        });\r\n    }\r\n\r\n    function sortRows(model, sortData, item) {\r\n        $.ajax({\r\n            url: baseUrlAdmin + '/api/sort-rows',\r\n            type: 'post',\r\n            data: {\r\n                \"model\": model,\r\n                \"data\": sortData\r\n            },\r\n            success: function (data, textStatus, jqXHR) {\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n                alert('Server error.');\r\n            }\r\n        });\r\n    }\r\n\r\n    initSortable();\r\n\r\n    // Select2\r\n    function initSelect2() {\r\n        $('select.select2').select2(\r\n            {placeholder: \"Select a State\", maximumSelectionSize: 6}\r\n        );\r\n    }\r\n\r\n    initSelect2();\r\n\r\n    // Fancybox\r\n    function initFancyBox() {\r\n        $('.fancybox').fancybox({\r\n            openEffect: 'none',\r\n            closeEffect: 'none'\r\n        });\r\n    }\r\n\r\n    $('body').on('click', '.fancy-close', function (e) {\r\n        e.preventDefault();\r\n        $.fancybox.close();\r\n    })\r\n\r\n    initFancyBox();\r\n\r\n    // Msg modal\r\n    $('#overlay-modal').modal();\r\n\r\n    // CKEditor\r\n    function initCkeditor() {\r\n        var roxyFileman = baseUrl + '/assets/admin/fileman/index.html';\r\n\r\n        CKEDITOR.disableAutoInline = true;\r\n        $('.ckeditor').ckeditor(\r\n            {\r\n                filebrowserBrowseUrl: roxyFileman,\r\n                filebrowserImageBrowseUrl: roxyFileman + '?type=image',\r\n                removeDialogTabs: 'link:upload;image:upload'\r\n            }\r\n        );\r\n    }\r\n\r\n    initCkeditor();\r\n\r\n    // Pjax\r\n    $.pjax.defaults.scrollTo = false;\r\n    $.pjax.defaults.timeout = 5000;\r\n\r\n    $('body').on('pjax:send', function () {\r\n        loaderShow();\r\n    })\r\n    $('body').on('pjax:complete', function () {\r\n        initSelect2();\r\n        initCkeditor();\r\n        loaderHide();\r\n        initSortable();\r\n        initColspan();\r\n        initFancyBoxCrop();\r\n    })\r\n\r\n    function addSubmitButtons(thisObj) {\r\n        $('<input>').attr({\r\n            type: 'hidden',\r\n            name: thisObj.attr('name'),\r\n            value: thisObj.attr('value')\r\n        }).appendTo(thisObj.closest('form'));\r\n    }\r\n\r\n    $('body').on('submit', 'form[data-pjax]', function (e) {\r\n        var btn = $(\":input[type=submit]:focus\");\r\n        if (btn.data('pjax')) {\r\n            addSubmitButtons(btn);\r\n            $.pjax.submit(e, {container: '#pjax-container'});\r\n        }\r\n    })\r\n\r\n    $('body').on('click', 'a[data-pjax]', function (e) {\r\n        $.pjax.click(e, {container: '#pjax-container'})\r\n    })\r\n\r\n    // Password generator\r\n    $('body').on('click', '[data-random-string]', function (e) {\r\n        e.preventDefault();\r\n        var element = $(this).data('random-string');\r\n        $(element).val(randomString());\r\n    })\r\n\r\n    // Boot box confirm with pjax options\r\n    // confirm, confirmPjax, submit, submitPjax\r\n    var bbFunction = {};\r\n\r\n    $('body').on('click', '[data-bb]', function (e) {\r\n        e.preventDefault();\r\n        var type = $(this).data('bb');\r\n        var thisObj = $(this);\r\n\r\n        if (typeof bbFunction[type] === 'function') {\r\n            bbFunction[type](thisObj);\r\n        }\r\n    });\r\n\r\n    bbFunction.confirm = function (thisObj) {\r\n        bootbox.confirm(\"Are you sure?\", function (result) {\r\n            if (result) {\r\n                location.href = thisObj.attr('href');\r\n            }\r\n        });\r\n    };\r\n\r\n    bbFunction.confirmPjax = function (thisObj) {\r\n        bootbox.confirm(\"Are you sure?\", function (result) {\r\n            if (result) {\r\n                $.pjax({url: thisObj.attr('href'), container: '#pjax-container'})\r\n            }\r\n        });\r\n    };\r\n\r\n    bbFunction.submit = function (thisObj) {\r\n        bootbox.confirm(\"Are you sure?\", function (result) {\r\n            if (result) {\r\n                addSubmitButtons(thisObj);\r\n                thisObj.closest('form').submit();\r\n            }\r\n        });\r\n    };\r\n\r\n    bbFunction.submitPjax = function (thisObj) {\r\n        bootbox.confirm(\"Are you sure?\", function (result) {\r\n            if (result) {\r\n                addSubmitButtons(thisObj);\r\n                thisObj.closest('form').on('submit', function (e) {\r\n                    $.pjax.submit(e, {container: '#pjax-container'});\r\n                }).submit()\r\n            }\r\n        });\r\n    };\r\n\r\n    // File button\r\n    $('body').on('fileselect', '.btn-file :file', function (event, numFiles, label) {\r\n        var input = $(this).parents('.input-group').find(':text');\r\n        var log = numFiles > 1 ? numFiles + ' files selected' : label;\r\n        if (input.length) {\r\n            input.val(log);\r\n        } else {\r\n            if (log) alert(log);\r\n        }\r\n    });\r\n\r\n    // Colspan\r\n    function initColspan() {\r\n        var count = $('.colspan').closest('table').find('thead tr').children().length;\r\n        $('.colspan').attr('colspan', count);\r\n    }\r\n\r\n    initColspan();\r\n\r\n    // Change status button\r\n    $('body').on('click', '.change-status', function (e) {\r\n        e.preventDefault();\r\n        var thisObj = $(this);\r\n        $.ajax({\r\n            url: baseUrlAdmin + '/api/change-status',\r\n            type: 'get',\r\n            data: {\r\n                \"model\": thisObj.data('model'),\r\n                \"id\": thisObj.data('id')\r\n            },\r\n            success: function (data, textStatus, jqXHR) {\r\n                thisObj.replaceWith(data);\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n                alert('Server error.');\r\n            }\r\n        });\r\n    })\r\n\r\n    // Image crop\r\n    function updateCoords(c) //update the cropped image cords on change\r\n    {\r\n        //console.log(c.x)\r\n        $('.fancybox-outer #x').text(Math.round(c.x));\r\n        $('.fancybox-outer #y').text(Math.round(c.y));\r\n        $('.fancybox-outer #w').text(Math.round(c.w));\r\n        $('.fancybox-outer #h').text(Math.round(c.h));\r\n\r\n        $('.fancybox-outer input[name=x]').val(Math.round(c.x));\r\n        $('.fancybox-outer input[name=y]').val(Math.round(c.y));\r\n        $('.fancybox-outer input[name=w]').val(Math.round(c.w));\r\n        $('.fancybox-outer input[name=h]').val(Math.round(c.h));\r\n\r\n    }\r\n\r\n    $('body').on('submit', '#jcrop-form', function (e) {\r\n        e.preventDefault();\r\n        var postData = $(this).serializeArray();\r\n        var formURL = $(this).attr(\"action\");\r\n        $.ajax(\r\n            {\r\n                url: formURL,\r\n                type: \"post\",\r\n                data: postData,\r\n                success: function (data, textStatus, jqXHR) {\r\n                    $.fancybox.close();\r\n                    parent.location.reload(true);\r\n                },\r\n                error: function (jqXHR, textStatus, errorThrown) {\r\n                    alert('Server error.')\r\n                }\r\n            });\r\n    })\r\n\r\n    function initFancyBoxCrop() {\r\n        $('.fancybox-crop').fancybox({\r\n            afterShow: function () {\r\n                $('.fancybox-outer #alt_new_crop').val($(this.element).closest('tr').find(\"input[name^='alt_update']\").first().val());\r\n                $('.fancybox-outer #description_new_crop').val($(this.element).closest('tr').find(\"input[name^='description_update']\").first().val());\r\n\r\n                $('.fancybox-outer input[name=image_id]').val($(this.element).attr('data-image-id'))\r\n                $('.fancybox-inner').find('img').Jcrop({\r\n                    allowMove: true,\r\n                    onChange: updateCoords,\r\n                    trueSize: [$(this.element).attr('data-w'), $(this.element).attr('data-h')]\r\n                });\r\n            },\r\n            beforeShow: function () {\r\n                $('#fancy-footer').clone().appendTo('.fancybox-outer').show();\r\n            }\r\n        });\r\n    }\r\n\r\n    initFancyBoxCrop();\r\n\r\n    // Reset form button\r\n    $('body').on('click', '.reset-form', function (e) {\r\n        e.preventDefault();\r\n        resetForm($(this).closest('form'));\r\n    })\r\n\r\n    // Add model content element\r\n    $('body').on('click', '.add-element-btn', function (e) {\r\n        e.preventDefault();\r\n        var select = $('.add-element');\r\n        $.ajax({\r\n            url: baseUrlAdmin + '/api/add-element',\r\n            type: 'get',\r\n            data: {\r\n                \"element\": select.select2('val')\r\n            },\r\n            success: function (data, textStatus, jqXHR) {\r\n                var html = $.parseHTML(data);\r\n                html = $(html).html();\r\n                $('#module-content-form').append(html);\r\n                initCkeditor();\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n                alert('Server error.');\r\n            }\r\n        });\r\n    })\r\n\r\n})"],"sourceRoot":"/source/"}