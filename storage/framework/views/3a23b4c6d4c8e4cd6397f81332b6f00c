<?php
$localConfigStr = "{$moduleLower}.model_content.element.{$contentType}";
$localConfig = config($localConfigStr, []);
?>
<table
<?php if(isset($item) && count($item->images)): ?>
    class="table table-bordered table-striped table-hover sortable" data-model="<?php echo e(get_class($item->images[0])); ?>"
<?php else: ?>
    class="table table-bordered table-striped table-hover"
<?php endif; ?>
>
    <thead>
    <tr>
        <th>Image</th>
        <th>Alt</th>
        <?php /* <th>Upload</th> */ ?>
        <?php if(array_get($localConfig, 'image.order')): ?>
            <th>Order</th>
        <?php endif; ?>
        <th>Status</th>
        <th>Actions</th>
    </tr>
    </thead>

    <tbody>
    <?php if(isset($item) && count($item->images)): ?>

        <?php foreach($item->images as $image): ?>
            <?php if(is_file(array_get($localConfig, 'image.path') . 'original/' . $image->image)): ?>
                <?php $size = getimagesize(array_get($localConfig, 'image.path') . 'original/' . $image->image); ?>
                <tr data-id="<?php echo e($image->id); ?>">
                    <td>

                        <?php echo link_to_image(
                        $image,
                        $localConfig,
                        [
                        'class' => 'img-thumbnail',
                        ],
                        [
                        'class' => 'fancybox', 'rel' => 'gallery',
                        'data-w' => $size[0],
                        'data-h' => $size[1],
                        'data-image-id' => $image->id,
                        ]
                        ); ?>

                    </td>
                    <td>
                        <?php echo Former::text("alt_update[{$image->id}]")->label(null)->value($image->alt)->placeholder('Enter alt text.'); ?>

                    </td>
                    <?php /*
                    <td class="w200">
                        <div class="input-group">
                            <span class="input-group-btn">
                                <span class="btn btn-default btn-file">
                                    Browse&hellip;  <input type="file"  name="files_update[{{$image->id}}]">
                                </span>
                            </span>
                            <input type="text" class="form-control" readonly>
                        </div>
                    </td>
                    */?>
                    <?php if(array_get($localConfig, 'image.order')): ?>
                        <td class="text-center">
                            <button type="button" class="btn btn-info btn-xs btn-sort">
                                <i class="fa fa-arrows-v w20"></i>
                            </button>
                        </td>
                    <?php endif; ?>
                    <td class="text-center">
                        <?php echo $statusButton($image); ?>

                    </td>
                    <td class="text-center">

                        <?php if(array_get($localConfig, 'image.crop')): ?>
                            <a href="<?php echo e(array_get($localConfig, 'image.baseUrl') . 'original/' . $image->image); ?>" class="btn btn-info btn-xs fancybox-crop"
                               data-w="<?php echo e($size[0]); ?>"
                               data-h="<?php echo e($size[1]); ?>"
                               data-image-id="<?php echo e($image->id); ?>">
                                <i class="fa fa-crop"></i> Crop
                            </a>
                        <?php endif; ?>

                        <a href="<?php echo e(route('api.admin.image.destroy', [$image->id, true, true])); ?>" class="btn btn-danger btn-xs" data-bb="confirmPjax">
                            <i class="fa fa-trash-o"></i> Delete
                        </a>
                    </td>
                </tr>
            <?php else: ?>
                <tr>
                    <td class="colspan">Whoops, looks like something went wrong,
                        file "<?php echo e($image->image); ?>" does not exist. Please delete record from database.
                        <a href="<?php echo e(route('api.admin.image.destroy', $image->id)); ?>" class="btn btn-danger btn-xs" data-bb="confirmPjax">
                            <i class="fa fa-trash-o"></i> Delete
                        </a>
                    </td>
                </tr>
            <?php endif; ?>
        <?php endforeach; ?>
    <?php else: ?>
        <tr>
            <td class="colspan">There is no items.</td>
        </tr>
    <?php endif; ?>
    </tbody>

</table>

<?php if(isset($item)): ?>

    <div class="form-group">
        <label class="col-xs-3 col-lg-2 control-label">New image upload</label>

        <div class="col-xs-9 col-lg-10">
            <div class="row bottom15">
                <div class="col-md-12">
                    <input type="text" class="form-control" value="" name="<?php echo e($item->id); ?>_alt_new[]"
                           placeholder="Enter alt text."/>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="input-group">
                    <span class="input-group-btn">
                        <span class="btn btn-default btn-file">
                            Browse&hellip; <input type="file" multiple name="<?php echo e($item->id); ?>_files_new[]">
                        </span>
                    </span>
                        <input type="text" class="form-control" readonly>
                    </div>
                </div>
            </div>
        </div>
    </div>

<?php else: ?>

    <div class="form-group">
        <label class="col-xs-3 col-lg-2 control-label">New image upload</label>

        <div class="col-xs-9 col-lg-10">
            <div class="row bottom15">
                <div class="col-md-12">
                    <input type="text" class="form-control" value="" name="<?php echo e($uniqid); ?>_alt_new[]"
                           placeholder="Enter alt text."/>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="input-group">
                    <span class="input-group-btn">
                        <span class="btn btn-default btn-file">
                            Browse&hellip; <input type="file" multiple name="<?php echo e($uniqid); ?>_files_new[]">
                        </span>
                    </span>
                        <input type="text" class="form-control" readonly>
                    </div>
                </div>
            </div>
        </div>
    </div>

<?php endif; ?>



